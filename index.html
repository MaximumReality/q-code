<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>Q-Code Solid Pyramid</title>
<style>
body { 
    margin: 0; 
    background: #000; 
    overflow: hidden; 
    height: 100vh; 
    display: flex; 
    justify-content: center; 
}

#pyramid-container { 
    position: relative; 
    width: 100%; 
    height: 100%; 
    perspective: 1000px; 
}

/* The Cube Container */
.cube {
    position: absolute;
    width: 60px;
    height: 60px;
    transition: all 0.2s ease;
}

/* Common style for all faces */
.face {
    position: absolute;
    width: 100%;
    height: 100%;
    box-sizing: border-box;
}

/* Top Diamond (Azul stands on) */
.top {
    background: #ff0055;
    transform: rotateX(60deg) rotateZ(45deg);
    border: 2px solid #ff88aa;
    z-index: 2;
}

/* Sides for depth */
.left-side {
    background: #990033; 
    transform: skewY(30deg) scaleX(0.5) translate(-50%, 50%);
    left: 0;
    top: 15px;
}

.right-side {
    background: #cc0044;
    transform: skewY(-30deg) scaleX(0.5) translate(50%, 50%);
    right: 0;
    top: 15px;
}

/* Compiled State - Neon Glow */
.cube.compiled .top {
    background: #00ffff;
    border: 2px solid #88ffff;
    box-shadow: 0 0 20px #00ffff;
}

/* Azul Sprite */
#azul {
    position: absolute;
    width: 50px;
    z-index: 999;
    pointer-events: none;
    transition: all 0.2s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    transform: translate(-50%, -90%);
}
</style>
</head>
<body>

<div id="pyramid-container">
    <img src="azul-tactical.png" id="azul">
</div>

<script>
const levels = 6;
const cubeSize = 60;
const spacing = 58; // Tight spacing for solid look
const container = document.getElementById("pyramid-container");
const azul = document.getElementById("azul");

let cubes = [];

// Function to build pyramid
function buildPyramid() {
    container.innerHTML = '';
    container.appendChild(azul); // Keep Azul on top
    cubes = [];

    const startY = window.innerHeight * 0.15;
    const centerX = window.innerWidth / 2;

    for(let r = 0; r < levels; r++) {
        for(let c = 0; c <= r; c++) {
            const cube = document.createElement("div");
            cube.className = "cube";
            cube.innerHTML = `
                <div class="face left-side"></div>
                <div class="face right-side"></div>
                <div class="face top"></div>
            `;

            // Position calculation
            const xPos = centerX + (c - r / 2) * spacing;
            const yPos = startY + r * spacing * 0.75;

            cube.style.left = (xPos - cubeSize / 2) + "px";
            cube.style.top = yPos + "px";

            // Better z-index for overlap
            cube.style.zIndex = levels - r + c;

            // Tap / click behavior
            cube.addEventListener("touchstart", (e) => {
                e.preventDefault();
                cube.classList.toggle("compiled");
                azul.style.left = xPos + "px";
                azul.style.top = yPos + cubeSize * 0.1 + "px";
                // Tiny pop animation
                cube.style.transform = "scale(1.1)";
                setTimeout(()=>cube.style.transform="scale(1)", 150);
            });

            container.appendChild(cube);
            cubes.push(cube);

            // Place Azul initially on top tile
            if(r === 0 && c === 0) {
                azul.style.left = xPos + "px";
                azul.style.top = yPos + cubeSize * 0.1 + "px";
            }
        }
    }
}

// Initial build
buildPyramid();

// Rebuild pyramid on resize to remain centered
window.addEventListener("resize", buildPyramid);
</script>

</body>
</html>
